<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login Page - Practice</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    section {
      border: 2px solid #ccc;
      padding: 20px;
      width: 480px;
      margin-bottom: 20px;
    }
    button {
      margin-top: 10px;
      margin-right: 10px;
      padding: 6px 12px;
      cursor: pointer;
    }
    .error {
      color: red;
      font-weight: bold;
    }
    .success {
      color: green;
      font-weight: bold;
    }
  </style>
</head>

<body>

<!-- ================= LOGIN SECTION ================= -->
<section id="loginSection">
  <h2>üîê Login Page</h2>

  <label>Username:</label><br>
  <input type="text" id="username" name="username"><br><br>

  <label>Password:</label><br>
  <input type="password" id="password" name="password"><br><br>

  <button id="loginBtn" onclick="login()">Login</button>
  <button id="loginNewWindowBtn" onclick="openLoginInNewWindow()">
    Login in New Window
  </button>

  <p id="loginMessage" class="error"></p>
</section>

<!-- ================= HOME SECTION ================= -->
<section id="homeSection" style="display:none;">
  <h2>üè† Home Page</h2>
  <p class="success">Welcome! Login successful.</p>

  <button onclick="logout()">Logout</button>
</section>

<!-- ================= NEW TAB PRACTICE ================= -->
<section id="newTabPractice">
  <h2>üÜï Open New Tab Practice</h2>

  <p>
    Clicking the button opens a <b>new browser tab</b>.
    The new tab updates its <b>page title</b> and shows a message.
  </p>

  <button onclick="openNewTab()">Open Page in New Tab</button>
</section>

<script>
  const validUsername = "admin";
  const validPassword = "admin123";

  /* -------- LOGIN -------- */
  function login() {
    const u = document.getElementById("username").value;
    const p = document.getElementById("password").value;
    const msg = document.getElementById("loginMessage");

    msg.innerText = "";

    if (u === validUsername && p === validPassword) {
      document.title = "Home Page - Dashboard";
      history.pushState({ page: "home" }, "", "#home");

      document.getElementById("loginSection").style.display = "none";
      document.getElementById("homeSection").style.display = "block";
    } else {
      msg.innerText = "‚ùå Invalid credentials. Please try again.";
    }
  }

  /* -------- LOGOUT -------- */
  function logout() {
    document.title = "Login Page - Practice";
    history.pushState({ page: "login" }, "", "#login");

    document.getElementById("homeSection").style.display = "none";
    document.getElementById("loginSection").style.display = "block";

    document.getElementById("username").value = "";
    document.getElementById("password").value = "";
    document.getElementById("loginMessage").innerText = "";
  }

  /* -------- LOGIN IN NEW WINDOW -------- */
  function openLoginInNewWindow() {
    const win = window.open("", "_blank", "width=500,height=400");

    win.document.write(`
      <html>
      <head>
        <title>Login - New Window</title>
        <style>
          body { font-family: Arial; margin: 30px; }
          .error { color: red; font-weight: bold; }
        </style>
      </head>
      <body>
        <h2>üîê Login (New Window)</h2>

        <input id="u" placeholder="Username"><br><br>
        <input id="p" type="password" placeholder="Password"><br><br>

        <button onclick="login()">Login</button>
        <p id="msg" class="error"></p>

        <script>
          function login() {
            if (u.value === "admin" && p.value === "admin123") {
              document.title = "Home - New Window";
              document.body.innerHTML =
                "<h2>üè† Home Page</h2><p>Login successful in new window.</p>";
            } else {
              msg.innerText = "‚ùå Invalid credentials";
            }
          }
        <\/script>
      </body>
      </html>
    `);

    win.document.close();
  }

  /* -------- NEW TAB LOGIC (SAME HTML) -------- */
  function openNewTab() {
    const tab = window.open("", "_blank");

    tab.document.write(`
      <html>
      <head>
        <title>New Tab Page</title>
        <style>
          body { font-family: Arial; margin: 40px; }
          h2 { color: green; }
        </style>
      </head>
      <body>
        <h2>üÜï New Tab Opened Successfully</h2>
        <p>This page was opened in a <b>new tab</b>.</p>
        <p>Page title is updated for Selenium validation.</p>
      </body>
      </html>
    `);

    tab.document.close();
  }

  /* -------- BACK / FORWARD HANDLING -------- */
  window.onpopstate = function (e) {
    if (e.state && e.state.page === "home") {
      document.title = "Home Page - Dashboard";
      loginSection.style.display = "none";
      homeSection.style.display = "block";
    } else {
      document.title = "Login Page - Practice";
      homeSection.style.display = "none";
      loginSection.style.display = "block";
    }
  };
</script>

</body>
</html>
